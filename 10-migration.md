# 移行戦略

<!-- 
Copyright (c) 2025 AWS SAP Study Guide
Licensed under the MIT License. See LICENSE file for details.
-->

## 目次

1. [移行の基本概念](#移行の基本概念)
2. [6つのR戦略](#6つのr戦略)
3. [アプリケーション移行](#アプリケーション移行)
4. [データベース移行](#データベース移行)
5. [データ移行](#データ移行)
6. [移行計画・実行](#移行計画実行)

---

## 移行の基本概念

### 移行の動機と目標

ビジネス要因

- **コスト削減**: CapExからOpExへの転換、運用コスト削減
- **俊敏性向上**: 迅速なリソース調達、グローバル展開
- **イノベーション促進**: 最新技術へのアクセス、AI/ML活用
- **スケーラビリティ**: 需要変動への柔軟な対応

技術要因

- **レガシーシステム**: 老朽化したインフラ、サポート終了
- **可用性・信頼性**: 単一障害点の排除、災害復旧能力向上
- **セキュリティ**: 最新のセキュリティ機能、コンプライアンス対応
- **保守性**: 運用負荷軽減、自動化の推進

### 移行の課題と考慮事項

技術的課題

- **アプリケーション依存関係**: 複雑な相互依存、レガシー技術
- **データ移行**: 大容量データ、ダウンタイム制約、整合性確保
- **パフォーマンス**: ネットワークレイテンシ、処理能力差異
- **互換性**: OS、ミドルウェア、アプリケーションの互換性

組織的課題

- **スキル不足**: クラウド技術知識、運用ノウハウ
- **変更管理**: 組織文化、プロセス変更、抵抗勢力
- **ガバナンス**: 責任分界、承認プロセス、コンプライアンス
- **コスト管理**: 予算計画、コスト可視化、最適化

### 移行評価フレームワーク

AWS Cloud Adoption Framework (CAF)

- **ビジネス**: 価値実現、ROI測定
- **人材**: スキル開発、組織変革
- **ガバナンス**: リスク管理、コンプライアンス
- **プラットフォーム**: アーキテクチャ設計、技術選択
- **セキュリティ**: セキュリティ統制、脅威対策
- **運用**: 運用モデル、監視・管理

移行準備度評価

- **現状分析**: 既存システムの棚卸し、依存関係マッピング
- **ビジネスケース**: コスト・ベネフィット分析、ROI算出
- **リスク評価**: 技術的・ビジネス的リスクの特定
- **組織準備度**: スキル、プロセス、文化の評価

---

## 6つのR戦略

### 1. Rehost (Lift and Shift)

基本概念

- 既存システムをそのままクラウドに移行
- 最小限の変更で迅速な移行を実現
- インフラレベルでの移行

適用場面

- **迅速な移行**: 短期間での移行が必要
- **リスク最小化**: 変更による影響を避けたい
- **コスト削減**: 即座にインフラコストを削減
- **レガシーシステム**: 変更が困難なシステム

メリット・デメリット

- **メリット**: 短期間、低リスク、即座にクラウドメリット享受
- **デメリット**: クラウドネイティブ機能未活用、長期的コスト効率低下
- **後続戦略**: 移行後にReplatform、Refactorを検討

実装アプローチ

- **AWS Application Migration Service**: 自動化された移行
- **VM Import/Export**: 仮想マシンイメージの移行
- **物理サーバー**: エージェントベースの移行

### 2. Replatform (Lift, Tinker, and Shift)

基本概念

- 基本アーキテクチャは維持しつつ、クラウドサービスを部分活用
- 段階的な最適化アプローチ
- 「クラウド最適化」とも呼ばれる

適用場面

- **段階的移行**: リスクを分散しながら移行
- **部分最適化**: 特定領域での改善を図る
- **運用負荷軽減**: マネージドサービスの活用
- **パフォーマンス向上**: クラウドサービスでの性能改善

典型的なパターン

- **データベース**: オンプレミスDB → RDS
- **ロードバランサー**: 物理LB → ELB/ALB
- **ファイルシステム**: NAS → EFS
- **バックアップ**: テープ → S3/Glacier

メリット・デメリット

- **メリット**: 適度なリスク、運用負荷軽減、コスト最適化
- **デメリット**: 完全なクラウドメリット未実現、複雑性増加
- **考慮事項**: 段階的な移行計画、依存関係の管理

### 3. Repurchase (Drop and Shop)

基本概念

- 既存ソフトウェアを廃止し、SaaSソリューションに移行
- ライセンス体系の変更
- 「SaaS移行」とも呼ばれる

適用場面

- **標準機能で十分**: カスタマイズが不要
- **運用負荷軽減**: インフラ・ソフトウェア管理の削減
- **最新機能活用**: SaaSの継続的な機能追加
- **コスト最適化**: ライセンス・運用コストの削減

典型的な移行例

- **CRM**: 自社システム → Salesforce
- **ERP**: オンプレミスERP → SAP on AWS、Workday
- **メール**: Exchange → Office 365、Google Workspace
- **HR**: 自社システム → Workday、SuccessFactors

検討事項

- **データ移行**: 既存データの移行可能性
- **統合**: 他システムとの連携
- **カスタマイズ**: 業務プロセスの標準化
- **ベンダーロックイン**: 将来の移行可能性

### 4. Refactor (Re-architect)

基本概念

- アーキテクチャを根本的に変更
- クラウドネイティブ設計の採用
- 最大限のクラウドメリット活用

適用場面

- **スケーラビリティ**: 大幅な拡張性向上が必要
- **パフォーマンス**: 劇的な性能改善が必要
- **コスト最適化**: 長期的な大幅コスト削減
- **イノベーション**: 新機能・サービスの実現

典型的なパターン

- **モノリス → マイクロサービス**: サービス分割、独立デプロイ
- **従来型 → サーバーレス**: Lambda、API Gateway活用
- **RDBMS → NoSQL**: DynamoDB、DocumentDBへの移行
- **バッチ → ストリーミング**: Kinesis、MSKでのリアルタイム処理

考慮事項

- **開発コスト**: 大幅な開発投資が必要
- **リスク**: 技術的リスク、プロジェクトリスク
- **スキル**: 新技術への習熟が必要
- **期間**: 長期間のプロジェクトとなる可能性

### 5. Retire

基本概念

- 不要なシステムを廃止
- 重複機能の統合
- ITポートフォリオの整理

適用場面

- **利用率低下**: 使用頻度が極めて低い
- **機能重複**: 他システムで代替可能
- **保守コスト高**: 維持コストが価値を上回る
- **技術的負債**: 古い技術で保守困難

廃止判断基準

- **ビジネス価値**: 事業への貢献度
- **利用状況**: アクセス頻度、ユーザー数
- **保守コスト**: 運用・保守にかかるコスト
- **代替手段**: 他システムでの代替可能性

廃止プロセス

- **影響分析**: 廃止による影響範囲の特定
- **データ保全**: 必要なデータの移行・アーカイブ
- **段階的廃止**: リスクを最小化した廃止手順
- **文書化**: 廃止理由・手順の記録

### 6. Retain

基本概念

- 現状維持、移行を延期
- 段階的移行の一部として位置づけ
- 将来的な移行を前提とした保持

保持理由

- **技術的制約**: 移行が技術的に困難
- **コンプライアンス**: 法的・規制要件
- **ビジネス継続性**: ミッションクリティカルで変更リスク大
- **ROI不足**: 移行コストが効果を上回る

保持戦略

- **定期見直し**: 保持理由の定期的な再評価
- **段階的準備**: 将来移行に向けた準備
- **リスク管理**: 保持に伴うリスクの管理
- **代替案検討**: 新たな移行オプションの検討

---

## アプリケーション移行

### 移行パターンと戦略

Strangler Fig Pattern

- **概念**: 新システムで既存機能を段階的に置換
- **メリット**: リスク分散、段階的移行、継続的価値提供
- **実装**: プロキシレイヤー、機能単位移行、段階的切り替え
- **適用場面**: 大規模システム、ミッションクリティカル

Database-per-Service Pattern

- **概念**: マイクロサービス毎に専用データベース
- **メリット**: データ独立性、技術選択自由度、スケーラビリティ
- **課題**: データ整合性、トランザクション管理、結合処理
- **対策**: イベント駆動、SAGA パターン、CQRS

### コンテナ化移行

移行アプローチ

- **App2Container**: 既存アプリケーションの自動コンテナ化
- **手動コンテナ化**: Dockerfileの作成、最適化
- **段階的移行**: 一部機能からの段階的コンテナ化

コンテナプラットフォーム選択

- **ECS**: AWS統合、シンプル運用、学習コスト低
- **EKS**: Kubernetes標準、ポータビリティ、豊富なエコシステム
- **Fargate**: サーバーレス、運用負荷軽減、変動負荷対応

### サーバーレス移行

移行対象の特定

- **イベント駆動処理**: ファイル処理、データ変換
- **API処理**: RESTful API、GraphQL
- **バッチ処理**: 定期実行、データ処理
- **統合処理**: システム間連携、ワークフロー

設計考慮事項

- **ステートレス設計**: 状態の外部化
- **イベント駆動**: 非同期処理、疎結合
- **エラーハンドリング**: 再試行、デッドレターキュー
- **監視・ログ**: 分散トレーシング、集約ログ

---

## データベース移行

### 移行戦略の選択

同種データベース移行

- **Oracle → Oracle on RDS**: 構造・機能互換性高
- **MySQL → Aurora MySQL**: MySQL互換、性能向上
- **SQL Server → RDS SQL Server**: Windows環境統合
- **PostgreSQL → Aurora PostgreSQL**: PostgreSQL互換、拡張性

異種データベース移行

- **Oracle → PostgreSQL**: オープンソース化、コスト削減
- **SQL Server → Aurora MySQL**: クロスプラットフォーム
- **商用DB → DynamoDB**: NoSQL化、スケーラビリティ向上
- **レガシーDB → DocumentDB**: ドキュメント指向、柔軟性

### AWS Database Migration Service (DMS)

基本概念

- **継続的レプリケーション**: 最小ダウンタイム移行
- **異種間移行**: Schema Conversion Tool連携
- **データ検証**: 移行データの整合性確認
- **監視・アラート**: 移行進捗の可視化

移行タイプ

- **フルロード**: 初期データの一括移行
- **CDC (Change Data Capture)**: 継続的な変更データ同期
- **フルロード + CDC**: 最小ダウンタイム移行

設計考慮事項

- **ネットワーク**: 帯域幅、レイテンシ、セキュリティ
- **リソース**: レプリケーションインスタンスのサイジング
- **監視**: 遅延、エラー、パフォーマンス監視
- **テスト**: データ整合性、パフォーマンステスト

### Schema Conversion Tool (SCT)

機能概要

- **自動変換**: DDL、DML、ストアドプロシージャ
- **評価レポート**: 変換可能性、工数見積もり
- **手動調整**: 変換不可項目の手動対応
- **コード生成**: 移行用スクリプト生成

変換対象

- **スキーマ**: テーブル、インデックス、制約
- **プロシージャ**: ストアドプロシージャ、関数
- **ビュー**: 複雑なビュー定義
- **トリガー**: データベーストリガー

---

## データ移行

### 大容量データ移行

AWS DataSync

- **用途**: オンプレミス ↔ AWS間のデータ同期
- **特徴**: 増分同期、帯域幅制御、データ検証
- **プロトコル**: NFS、SMB、HDFS、S3、EFS
- **適用場面**: 継続的同期、初期移行、災害復旧

AWS Snow Family

- **Snowcone**: 8TB、エッジコンピューティング
- **Snowball Edge**: 80TB、ローカル処理可能
- **Snowmobile**: 100PB、超大容量移行
- **適用場面**: 大容量データ、低帯域幅環境、セキュリティ要件

### ストレージ移行戦略

段階的移行

- **ホット → コールド**: アクセス頻度による段階化
- **ライフサイクル管理**: 自動的なストレージクラス移行
- **コスト最適化**: 保存コストと取得コストのバランス

ハイブリッド構成

- **Storage Gateway**: オンプレミス ↔ クラウド統合
- **File Gateway**: NFS/SMB → S3
- **Volume Gateway**: iSCSI → S3
- **Tape Gateway**: VTL → S3/Glacier

### データ整合性とバックアップ

整合性確保

- **チェックサム検証**: データ転送時の整合性確認
- **増分バックアップ**: 変更分のみの効率的バックアップ
- **ポイントインタイム**: 特定時点への復旧可能性
- **クロスリージョン**: 地理的分散によるリスク軽減

バックアップ戦略

- **3-2-1ルール**: 3つのコピー、2つの媒体、1つのオフサイト
- **自動化**: スケジュール実行、ライフサイクル管理
- **テスト**: 定期的な復旧テスト、RTO/RPO検証
- **監視**: バックアップ成功/失敗の監視

---

## 移行計画・実行

### 移行プロジェクト管理

フェーズ別アプローチ

1. **評価・計画**: 現状分析、移行戦略策定、ROI算出
2. **設計・準備**: アーキテクチャ設計、移行計画詳細化
3. **パイロット**: 小規模移行、プロセス検証
4. **本格移行**: Wave単位での段階的移行
5. **最適化**: パフォーマンス調整、コスト最適化

Wave計画

- **Wave 1**: 低リスク、シンプルなシステム
- **Wave 2**: 標準的なアプリケーション
- **Wave 3**: 複雑なシステム、依存関係あり
- **Wave 4**: ミッションクリティカル、高リスク

### リスク管理

技術的リスク

- **互換性問題**: アプリケーション、OS、ミドルウェア
- **パフォーマンス劣化**: レスポンス時間、スループット
- **データ損失**: 移行時の整合性、バックアップ
- **セキュリティ**: 設定ミス、アクセス制御

ビジネスリスク

- **サービス停止**: ダウンタイム、業務影響
- **コスト超過**: 予算オーバー、隠れたコスト
- **スケジュール遅延**: 依存関係、リソース不足
- **品質問題**: 機能不具合、ユーザビリティ

リスク軽減策

- **十分なテスト**: 機能、性能、統合テスト
- **ロールバック計画**: 問題発生時の復旧手順
- **段階的移行**: リスク分散、影響最小化
- **監視・アラート**: 早期問題検出、迅速対応

### 移行実行とカットオーバー

カットオーバー戦略

- **ビッグバン**: 一括切り替え、短時間完了
- **段階的**: 機能・ユーザー単位での段階切り替え
- **並行運用**: 新旧システム並行、段階的移行
- **ブルーグリーン**: 環境切り替え、即座のロールバック

実行管理

- **チェックリスト**: 詳細な作業手順、確認項目
- **コミュニケーション**: ステークホルダーへの状況報告
- **監視**: システム状態、パフォーマンス監視
- **エスカレーション**: 問題発生時の対応体制

### 移行後最適化

パフォーマンス最適化

- **リソース最適化**: インスタンスタイプ、サイジング
- **ネットワーク最適化**: CDN、VPC Endpoint活用
- **データベース最適化**: インデックス、クエリチューニング
- **キャッシュ活用**: ElastiCache、CloudFront

コスト最適化

- **リザーブドインスタンス**: 長期利用でのコスト削減
- **スポットインスタンス**: 適用可能ワークロードでの活用
- **ストレージ最適化**: ライフサイクル管理、適切なクラス選択
- **監視・分析**: Cost Explorer、Trusted Advisor活用

運用最適化

- **自動化**: デプロイ、監視、バックアップの自動化
- **監視**: CloudWatch、X-Ray、Config活用
- **セキュリティ**: Security Hub、GuardDuty、Inspector
- **ガバナンス**: Organizations、Control Tower、Well-Architected

---

## まとめ

### 試験でのポイント

移行戦略の選択基準

1. **ビジネス要件**: 時間、コスト、リスク許容度
2. **技術的制約**: 互換性、依存関係、複雑性
3. **組織的要因**: スキル、リソース、変更許容度
4. **長期的視点**: 将来の拡張性、保守性、最適化

よくある移行パターン

- **段階的移行**: リスク分散、継続的価値提供
- **ハイブリッド構成**: オンプレミスとクラウドの組み合わせ
- **データ中心**: データベース・ストレージ移行優先
- **アプリケーション中心**: アプリケーション現代化優先

成功要因

- **十分な計画**: 詳細な現状分析、リスク評価
- **段階的実行**: Wave計画、パイロット実施
- **継続的最適化**: 移行後の改善、コスト最適化
- **組織的取り組み**: スキル開発、変更管理、ガバナンス

---

## ライセンス

このコンテンツは MIT License の下で公開されています。詳細は [LICENSE](./LICENSE) ファイルをご確認ください。
