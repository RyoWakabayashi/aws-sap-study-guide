# コンピューティングサービス

<!-- 
Copyright (c) 2025 AWS SAP Study Guide
Licensed under the MIT License. See LICENSE file for details.
-->

## 目次

1. [EC2 (Elastic Compute Cloud)](#ec2-elastic-compute-cloud)
2. [コンテナサービス](#コンテナサービス)
3. [サーバーレスコンピューティング](#サーバーレスコンピューティング)
4. [バッチ処理](#バッチ処理)
5. [Auto Scaling](#auto-scaling)
6. [サービス選択の指針](#サービス選択の指針)

---

## EC2 (Elastic Compute Cloud)

### 基本概念と特徴

EC2の位置づけ

- AWSの基盤となる仮想サーバーサービス
- 最も柔軟性が高く、あらゆるワークロードに対応可能
- インフラレベルの制御が必要な場合の第一選択肢

主要な特徴

- **完全な管理者権限**: OS レベルからの制御が可能
- **豊富なインスタンスタイプ**: ワークロードに最適化された選択肢
- **柔軟な料金体系**: オンデマンド、リザーブド、スポットインスタンス
- **高い可用性**: 複数AZでの冗長構成が可能

### インスタンスタイプの選択指針

汎用インスタンス（T, M シリーズ）

- **使用場面**: 一般的なWebアプリケーション、小〜中規模データベース
- **特徴**: CPUとメモリのバランスが良い
- **T シリーズ**: バーストパフォーマンス、変動するワークロード向け
- **M シリーズ**: 安定したパフォーマンス、予測可能なワークロード向け

コンピューティング最適化（C シリーズ）

- **使用場面**: 高性能Webサーバー、科学計算、ゲームサーバー
- **特徴**: 高性能プロセッサ、CPU集約的処理に最適
- **選択基準**: CPU使用率が継続的に高いワークロード

メモリ最適化（R, X, Z シリーズ）

- **使用場面**: インメモリデータベース、リアルタイム分析、キャッシュ
- **特徴**: 大容量メモリ、メモリ集約的処理に最適
- **選択基準**: 大量のデータをメモリに保持する必要がある場合

ストレージ最適化（I, D シリーズ）

- **使用場面**: 分散ファイルシステム、データウェアハウス、高頻度OLTP
- **特徴**: 高速なローカルストレージ、高いIOPS
- **選択基準**: ストレージ性能がボトルネックとなるワークロード

### 購入オプションの使い分け

オンデマンドインスタンス

- **適用場面**: 開発・テスト環境、予測不可能なワークロード
- **メリット**: 柔軟性、初期コストなし
- **デメリット**: 最も高い時間単価

リザーブドインスタンス

- **適用場面**: 安定した本番環境、予測可能なワークロード
- **メリット**: 最大75%のコスト削減
- **選択基準**: 1年以上の継続利用が見込める場合

スポットインスタンス

- **適用場面**: バッチ処理、障害許容性のあるワークロード
- **メリット**: 最大90%のコスト削減
- **注意点**: 中断される可能性、ステートレスな処理に限定

Savings Plans

- **適用場面**: 複数のサービスを組み合わせて利用
- **メリット**: EC2、Fargate、Lambdaに適用可能
- **選択基準**: 柔軟性とコスト削減のバランス

### 設計上の考慮事項

可用性設計

- **マルチAZ配置**: 単一障害点の排除
- **Auto Scaling**: 需要変動への自動対応
- **ロードバランサー**: トラフィック分散と健全性チェック

セキュリティ設計

- **セキュリティグループ**: ステートフルファイアウォール
- **NACLs**: サブネットレベルのアクセス制御
- **IAMロール**: 一時的な認証情報の提供

パフォーマンス最適化

- **プレイスメントグループ**: ネットワーク性能の最適化
- **拡張ネットワーキング**: SR-IOV、DPDK対応
- **EBS最適化**: ストレージ性能の向上

---

### 公式リソース

- [EC2 サービス紹介](https://aws.amazon.com/jp/ec2/)
- [EC2 Black Belt](https://aws.amazon.com/jp/blogs/news/aws-black-belt-seminar-amazon-ec2-introduction/)
- [EC2 インスタンスタイプ](https://aws.amazon.com/jp/ec2/instance-types/)

## コンテナサービス

### ECS (Elastic Container Service)

基本概念

- AWSネイティブなコンテナオーケストレーションサービス
- DockerコンテナをAWS環境で簡単に実行・管理
- AWS他サービスとの深い統合

主要コンポーネント

- **クラスター**: コンテナインスタンスの論理グループ
- **タスク定義**: コンテナの設定テンプレート
- **サービス**: タスクの実行とスケーリングを管理
- **タスク**: 実行中のコンテナインスタンス

使用場面

- **マイクロサービスアーキテクチャ**: サービス間の疎結合
- **CI/CDパイプライン**: コンテナベースのデプロイメント
- **レガシーアプリケーションの移行**: 段階的なコンテナ化

ECS vs EKS の選択基準

- **ECS選択**: AWS環境に特化、シンプルな運用、AWS統合重視
- **EKS選択**: Kubernetes標準、マルチクラウド、既存K8s資産活用

#### 公式リソース

- [ECS サービス紹介](https://aws.amazon.com/jp/ecs/)
- [ECS Black Belt](https://aws.amazon.com/jp/blogs/news/aws-black-belt-online-seminar-con201-ecs-overview/)
- [ECS ベストプラクティス](https://docs.aws.amazon.com/AmazonECS/latest/bestpracticesguide/)

### EKS (Elastic Kubernetes Service)

基本概念

- マネージドKubernetesサービス
- Kubernetesコントロールプレーンの運用をAWSが担当
- CNCF認定、標準的なKubernetes API

主要な特徴

- **標準準拠**: 標準的なKubernetes環境
- **マルチクラウド対応**: ポータビリティの確保
- **豊富なエコシステム**: Kubernetesツールチェーンの活用

使用場面

- **既存Kubernetes資産**: オンプレミスからの移行
- **マルチクラウド戦略**: ベンダーロックイン回避
- **複雑なワークロード**: 高度なオーケストレーション要件

運用上の考慮事項

- **学習コスト**: Kubernetesの専門知識が必要
- **運用複雑性**: より多くの設定と管理が必要
- **コスト**: コントロールプレーンの追加料金

#### 公式リソース

- [EKS サービス紹介](https://aws.amazon.com/jp/eks/)
- [EKS Black Belt](https://aws.amazon.com/jp/blogs/news/aws-black-belt-online-seminar-con221-introduction-eks/)
- [EKS ベストプラクティス](https://aws.github.io/aws-eks-best-practices/)

### Fargate

基本概念

- サーバーレスコンテナ実行環境
- インフラ管理不要、コンテナに集中可能
- ECS、EKS両方で利用可能

主要な特徴

- **インフラ抽象化**: サーバー管理が不要
- **自動スケーリング**: 需要に応じた自動調整
- **セキュリティ**: タスクレベルの分離

使用場面

- **運用負荷軽減**: インフラ管理を避けたい場合
- **変動するワークロード**: 予測困難な負荷パターン
- **開発効率重視**: アプリケーション開発に集中

EC2 vs Fargate の選択基準

- **EC2選択**: コスト最適化、特殊な要件、長時間実行
- **Fargate選択**: 運用簡素化、短時間実行、変動負荷

### 公式リソース

- [Fargate サービス紹介](https://aws.amazon.com/jp/fargate/)
- [Fargate Black Belt](https://aws.amazon.com/jp/blogs/news/webinar-bb-aws-fargate-2019/)

---

## サーバーレスコンピューティング

### Lambda

基本概念

- イベント駆動型のサーバーレス実行環境
- コードの実行時間に対してのみ課金
- 自動スケーリング、高可用性を内蔵

主要な特徴

- **イベント駆動**: 様々なAWSサービスとの統合
- **自動スケーリング**: 同時実行数の自動調整
- **多言語対応**: 主要プログラミング言語をサポート
- **ステートレス**: 関数間での状態共有なし

使用場面

- **APIバックエンド**: API Gatewayとの組み合わせ
- **データ処理**: S3、DynamoDBのイベント処理
- **定期実行**: CloudWatch Eventsでのスケジュール実行
- **リアルタイム処理**: Kinesis、SQSとの連携

設計上の考慮事項

- **実行時間制限**: 最大15分の制約
- **コールドスタート**: 初回実行時の遅延
- **同時実行制限**: アカウント・リージョンレベルの制限
- **メモリ設定**: パフォーマンスとコストのバランス

Lambda vs EC2 の選択基準

- **Lambda選択**: 短時間処理、イベント駆動、運用負荷軽減
- **EC2選択**: 長時間処理、常時稼働、特殊な環境要件

#### 公式リソース

- [Lambda サービス紹介](https://aws.amazon.com/jp/lambda/)
- [Lambda Black Belt](https://aws.amazon.com/jp/modern-apps/recommendation-guide/serverless/aws-lambda/)
- [Lambda ベストプラクティス](https://docs.aws.amazon.com/lambda/latest/dg/best-practices.html)

### Step Functions

基本概念

- サーバーレスワークフローオーケストレーション
- 複数のAWSサービスを組み合わせたワークフロー構築
- 視覚的なワークフロー定義と監視

主要な特徴

- **状態管理**: ワークフローの状態を自動管理
- **エラーハンドリング**: 再試行、エラー分岐の定義
- **並列処理**: 複数タスクの並列実行
- **視覚化**: ワークフローの可視化と監視

使用場面

- **複雑なビジネスプロセス**: 多段階の処理フロー
- **データパイプライン**: ETL処理の自動化
- **マイクロサービス連携**: サービス間の調整

---

## バッチ処理

### AWS Batch

基本概念

- 大規模バッチ処理のためのフルマネージドサービス
- コンピューティングリソースの自動プロビジョニング
- ジョブキューとスケジューリングの管理

主要な特徴

- **動的スケーリング**: 需要に応じたリソース調整
- **コスト最適化**: スポットインスタンスの活用
- **ジョブ依存関係**: 複雑な依存関係の管理
- **多様な実行環境**: EC2、Fargate、EKSでの実行

使用場面

- **科学計算**: 大規模シミュレーション、解析処理
- **画像・動画処理**: メディアファイルの変換
- **データ処理**: 大量データのETL処理
- **機械学習**: モデル訓練、推論処理

設計パターン

- **ジョブキュー**: 優先度に基づく処理順序制御
- **コンピューティング環境**: リソースタイプの最適化
- **ジョブ定義**: 実行環境とリソース要件の定義

---

## Auto Scaling

### EC2 Auto Scaling

基本概念

- EC2インスタンスの自動スケーリング
- 需要変動に応じたキャパシティ調整
- 可用性とコストの最適化

スケーリングポリシー

- **ターゲット追跡**: 特定メトリクスの目標値維持
- **ステップスケーリング**: 段階的なスケーリング
- **シンプルスケーリング**: 単純な閾値ベース
- **予測スケーリング**: 機械学習による予測

設計上の考慮事項

- **スケーリング指標**: CPU、メモリ、カスタムメトリクス
- **クールダウン期間**: スケーリング動作の安定化
- **ヘルスチェック**: インスタンスの健全性監視
- **AZ分散**: 可用性を考慮した配置

### Application Auto Scaling

対象サービス

- ECS サービス
- DynamoDB テーブル
- Aurora レプリカ
- Lambda 同時実行数
- その他多数のAWSサービス

統一されたスケーリング体験

- 一貫したAPIとコンソール体験
- 共通のスケーリングポリシー
- 統合された監視とアラート

### 公式リソース

- [Auto Scaling サービス紹介](https://aws.amazon.com/jp/autoscaling/)
- [Auto Scaling Black Belt](https://aws.amazon.com/jp/blogs/news/webinar-bb-amazon-ec2-auto-scaling-and-aws-auto-scaling-2019/)

---

## サービス選択の指針

### ワークロード特性による選択

継続稼働型アプリケーション

- **EC2**: 長時間稼働、安定した負荷
- **ECS/EKS**: マイクロサービス、コンテナ化済み
- **考慮事項**: 可用性、スケーラビリティ、運用負荷

イベント駆動型処理

- **Lambda**: 短時間、非同期処理
- **Step Functions**: 複雑なワークフロー
- **考慮事項**: 実行時間、頻度、複雑性

バッチ処理

- **Batch**: 大規模、並列処理
- **Lambda**: 軽量、定期実行
- **EC2**: 特殊要件、長時間処理

### コスト最適化の観点

予測可能なワークロード

- リザーブドインスタンス、Savings Plans
- 適切なインスタンスサイジング
- スケジュールベースのスケーリング

変動するワークロード

- Auto Scaling の活用
- スポットインスタンスの検討
- サーバーレスアーキテクチャ

開発・テスト環境

- スポットインスタンス
- 自動停止・開始
- 小さなインスタンスタイプ

### 運用負荷の観点

運用負荷を最小化

- マネージドサービスの選択
- サーバーレスアーキテクチャ
- 自動化の推進

制御性を重視

- EC2 での詳細制御
- カスタム設定の必要性
- 特殊な要件への対応

### セキュリティの観点

分離レベル

- **VM レベル**: EC2 インスタンス
- **コンテナレベル**: ECS、EKS
- **関数レベル**: Lambda

ネットワーク制御

- VPC での詳細制御
- セキュリティグループ、NACL
- プライベートサブネット配置

アクセス制御

- IAM ロールの適切な設定
- 最小権限の原則
- 一時的な認証情報の使用

---

## まとめ

### 試験でのポイント

サービス選択の判断基準

1. **ワークロードの特性**: 継続性、実行時間、負荷パターン
2. **運用要件**: 管理負荷、制御レベル、専門知識
3. **コスト要件**: 予算制約、最適化の必要性
4. **セキュリティ要件**: 分離レベル、コンプライアンス
5. **可用性要件**: SLA、災害復旧、冗長性

よくある設計パターン

- **3層アーキテクチャ**: Web、App、DB層の分離
- **マイクロサービス**: サービス分割とコンテナ化
- **サーバーレス**: イベント駆動とFaaS活用
- **ハイブリッド**: 複数サービスの組み合わせ

コスト最適化戦略

- **適切なサイジング**: 過剰スペックの回避
- **購入オプション**: リザーブド、スポット活用
- **自動スケーリング**: 需要変動への対応
- **ライフサイクル管理**: 不要リソースの削除

---

## ライセンス

このコンテンツは MIT License の下で公開されています。詳細は [LICENSE](./LICENSE) ファイルをご確認ください。
